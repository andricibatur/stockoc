<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Stok Gudang - Google Sheet API</title>
  <style>
    body { font-family: sans-serif; padding: 20px; }
    input, button { margin: 5px 0; padding: 6px; width: 100%; max-width: 300px; box-sizing: border-box; }
    table { border-collapse: collapse; width: 100%; margin-top: 15px; }
    th, td { border: 1px solid #ccc; padding: 6px; text-align: left; }
    th { background: #f0f0f0; }
    #form-container { max-width: 320px; }
  </style>
</head>
<body>

  <h2>ðŸ“¦ Stok Gudang (Google Sheet)</h2>

  <div id="form-container">
    <label for="nama">Nama Barang:</label><br>
    <input id="nama" type="text" placeholder="Contoh: Indomie"><br>

    <label for="jumlah">Jumlah:</label><br>
    <input id="jumlah" type="number" placeholder="Contoh: 100"><br>

    <button id="btn-simpan">Simpan ke Sheet</button>
  </div>

  <h3>ðŸ“‹ Daftar Stok</h3>
  <table>
    <thead>
      <tr>
        <th>Tanggal</th>
        <th>Nama</th>
        <th>Jumlah</th>
      </tr>
    </thead>
    <tbody id="tabel-stok"></tbody>
  </table>

  <script>
    // URL Apps Script Web App (ganti dengan ID yang sudah diberikan Inul)
    const scriptURL = 'https://script.google.com/macros/s/AKfycbwG2NQgJyoNyqK8NFgA0FrKzFVgCrnQNoflOuIAVPwqctALK2idan56t8IIHPo0FCnGew/exec';

    // Ambil elemen
    const btnSimpan = document.getElementById('btn-simpan');
    const inputNama = document.getElementById('nama');
    const inputJumlah = document.getElementById('jumlah');
    const tbody = document.getElementById('tabel-stok');

    // Fungsi untuk memuat data dari Sheet
    function muatData() {
      fetch(scriptURL)
        .then(res => res.json())
        .then(data => {
          // data[0] diasumsikan header; skip index 0
          tbody.innerHTML = '';
          // urutkan terbaru di atas (data slice tanpa header, lalu reverse)
          data.slice(1).reverse().forEach(row => {
            const tanggal = new Date(row[0]).toLocaleString();
            const nama = row[1];
            const jumlah = row[2];
            const tr = document.createElement('tr');
            tr.innerHTML = `
              <td>${tanggal}</td>
              <td>${nama}</td>
              <td>${jumlah}</td>
            `;
            tbody.appendChild(tr);
          });
        })
        .catch(err => {
          console.error('Error muat data:', err);
        });
    }

    // Fungsi untuk menyimpan ke Sheet
    function simpanData() {
      const nama = inputNama.value.trim();
      const jumlah = inputJumlah.value.trim();
      if (!nama || !jumlah) {
        alert('Isi semua kolom sebelum simpan.');
        return;
      }

      const formData = new URLSearchParams();
      formData.append('nama', nama);
      formData.append('jumlah', jumlah);

      fetch(scriptURL, {
        method: 'POST',
        body: formData
      })
      .then(res => res.text())
      .then(resText => {
        // Clear form dan reload tabel
        inputNama.value = '';
        inputJumlah.value = '';
        muatData();
      })
      .catch(err => {
        console.error('Error simpan data:', err);
      });
    }

    // Event listener tombol
    btnSimpan.addEventListener('click', simpanData);

    // Muat data pertama kali saat halaman dibuka
    muatData();
  </script>

</body>
</html>
